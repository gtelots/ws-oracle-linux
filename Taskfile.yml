# https://taskfile.dev

version: '3'

env:
  DOCKER_BUILDKIT: 1

dotenv: [".env"]

tasks:
  default:
    desc: Show available commands
    silent: true
    cmds:
      - |
        echo ""
        echo "ğŸ§ Oracle Linux 9 Development Container"
        echo "========================================"
        echo ""
        echo "ğŸ“¦ Container Management"
        echo "  task up                     Start the development container"
        echo "  task down                   Stop the development container"
        echo "  task restart                Restart the development container"
        echo "  task build                  Build the container image"
        echo "  task rebuild                Rebuild and restart the container"
        echo "  task fresh                  Fresh install (rebuild everything)"
        echo ""
        echo "ğŸš€ Development Workflows"
        echo "  task dev                    Start development mode with enhanced features"
        echo "  task dev-full               Start with all tools enabled"
        echo "  task dev-minimal            Start with minimal tools for faster startup"
        echo "  task shell                  Open a shell in the container"
        echo "  task root                   Open a shell as root user"
        echo "  task ssh                    SSH into the container"
        echo ""
        echo "ğŸ” Information & Monitoring"
        echo "  task ps                     Show container status"
        echo "  task logs                   Show container logs"
        echo "  task tools                  List installed tools and versions"
        echo "  task health                 Check container health and system status"
        echo "  task config                 Show current configuration"
        echo "  task monitor                Monitor container resources in real-time"
        echo ""
        echo "ğŸ§ª Testing & Validation"
        echo "  task test                   Run comprehensive functionality tests"
        echo "  task test-tools             Test essential tools functionality"
        echo "  task test-services          Test container services"
        echo "  task test-network           Test network connectivity"
        echo "  task benchmark              Run performance benchmarks"
        echo ""
        echo "ğŸ”’ Security & Maintenance"
        echo "  task security-scan          Run security scans on the container"
        echo "  task update                 Update system packages"
        echo "  task backup                 Backup container data and configurations"
        echo "  task restore                Restore container data from backup"
        echo ""
        echo "ğŸ§¹ Cleanup & Utilities"
        echo "  task clean                  Clean up Docker resources"
        echo "  task clean-all              Full cleanup including images and volumes"
        echo "  task docs                   Generate and serve documentation"
        echo ""
        echo "ğŸ’¡ Quick Start:"
        echo "  task dev                    # Start development environment"
        echo "  task tools                  # Check installed tools"
        echo "  task health                 # Verify everything is working"
        echo ""

  up:
    desc: Start the development container
    cmds:
      - echo "Starting container..."
      - docker compose up -d
      - echo "Container started successfully!"

  down:
    desc: Stop the development container
    cmds:
      - echo "Stopping container..."
      - docker compose down
      - echo "Container stopped successfully!"

  restart:
    desc: Restart the development container
    cmds:
      - echo "Restarting container..."
      - docker compose restart
      - echo "Container restarted successfully!"

  build:
    desc: Build the container image
    cmds:
      - echo "Building container image..."
      - docker compose build
      - echo "Build completed successfully!"

  rebuild:
    desc: Rebuild and restart the container
    cmds:
      - echo "Rebuilding container..."
      - task: down
      - task: build
      - task: up

  fresh:
    desc: Fresh install - rebuild everything from scratch
    cmds:
      - echo "Fresh install - cleaning and rebuilding..."
      - docker compose down -v --remove-orphans
      - docker system prune -f
      - docker compose build --no-cache
      - docker compose up -d
      - echo "Fresh install completed!"

  shell:
    desc: Open an interactive shell in the container
    cmds:
      - docker compose exec workspace bash

  root:
    desc: Open an interactive shell as root user
    cmds:
      - docker compose exec --user root workspace bash

  ssh:
    desc: SSH into the container
    cmds:
      - ssh -p 2222 {{.USER_NAME}}@localhost

  ps:
    desc: Show container status
    cmds:
      - docker compose ps

  logs:
    desc: Display container logs
    cmds:
      - docker compose logs -f workspace

  clean:
    desc: Clean up Docker resources
    cmds:
      - echo "Cleaning up Docker resources..."
      - docker system prune -f
      - echo "Cleanup completed!"

  clean-all:
    desc: Full cleanup including images and volumes
    cmds:
      - echo "Full Docker cleanup..."
      - docker compose down -v --remove-orphans
      - docker system prune -af
      - docker volume prune -f
      - echo "Full cleanup completed!"

  # =============================================================================
  # DEVELOPMENT AND TESTING TASKS
  # =============================================================================

  tools:
    desc: List installed tools and their versions
    cmds:
      - echo "ğŸ“‹ Installed Development Tools:"
      - echo "================================"
      - docker compose exec workspace bash -c '
          echo "ğŸ—ï¸  Infrastructure & DevOps:";
          command -v ansible >/dev/null && echo "  âœ… Ansible: $(ansible --version 2>/dev/null | head -n1 | cut -d\" \" -f3)" || echo "  âŒ Ansible: Not installed";
          command -v terraform >/dev/null && echo "  âœ… Terraform: $(terraform version 2>/dev/null | head -n1 | cut -d\" \" -f2)" || echo "  âŒ Terraform: Not installed";
          command -v teleport >/dev/null && echo "  âœ… Teleport: $(teleport version 2>/dev/null | head -n1)" || echo "  âŒ Teleport: Not installed";
          echo "";
          echo "â˜¸ï¸  Kubernetes Tools:";
          command -v kubectl >/dev/null && echo "  âœ… kubectl: $(kubectl version --client --short 2>/dev/null)" || echo "  âŒ kubectl: Not installed";
          command -v helm >/dev/null && echo "  âœ… Helm: $(helm version --short 2>/dev/null)" || echo "  âŒ Helm: Not installed";
          command -v k9s >/dev/null && echo "  âœ… k9s: $(k9s version --short 2>/dev/null)" || echo "  âŒ k9s: Not installed";
          echo "";
          echo "ğŸ³ Container Tools:";
          command -v docker >/dev/null && echo "  âœ… Docker: $(docker --version 2>/dev/null | cut -d\" \" -f3 | tr -d \",\")" || echo "  âŒ Docker: Not installed";
          command -v dry >/dev/null && echo "  âœ… dry: $(dry --version 2>/dev/null)" || echo "  âŒ dry: Not installed";
          command -v lazydocker >/dev/null && echo "  âœ… lazydocker: $(lazydocker --version 2>/dev/null)" || echo "  âŒ lazydocker: Not installed";
          echo "";
          echo "â˜ï¸  Cloud Tools:";
          command -v aws >/dev/null && echo "  âœ… AWS CLI: $(aws --version 2>/dev/null | cut -d\" \" -f1 | cut -d/ -f2)" || echo "  âŒ AWS CLI: Not installed";
          command -v cloudflared >/dev/null && echo "  âœ… Cloudflared: $(cloudflared --version 2>/dev/null)" || echo "  âŒ Cloudflared: Not installed";
          command -v tailscale >/dev/null && echo "  âœ… Tailscale: $(tailscale version 2>/dev/null)" || echo "  âŒ Tailscale: Not installed";
          echo "";
          echo "ğŸ”§ Modern CLI Tools:";
          command -v nvim >/dev/null && echo "  âœ… Neovim: $(nvim --version 2>/dev/null | head -n1 | cut -d\" \" -f2)" || echo "  âŒ Neovim: Not installed";
          command -v fd >/dev/null && echo "  âœ… fd: $(fd --version 2>/dev/null)" || echo "  âŒ fd: Not installed";
          command -v rg >/dev/null && echo "  âœ… ripgrep: $(rg --version 2>/dev/null | head -n1)" || echo "  âŒ ripgrep: Not installed";
          command -v bat >/dev/null && echo "  âœ… bat: $(bat --version 2>/dev/null)" || echo "  âŒ bat: Not installed";
          command -v exa >/dev/null && echo "  âœ… exa: $(exa --version 2>/dev/null | head -n1)" || echo "  âŒ exa: Not installed";
          command -v http >/dev/null && echo "  âœ… HTTPie: $(http --version 2>/dev/null)" || echo "  âŒ HTTPie: Not installed";
          command -v btm >/dev/null && echo "  âœ… bottom: $(btm --version 2>/dev/null)" || echo "  âŒ bottom: Not installed";
          command -v trivy >/dev/null && echo "  âœ… Trivy: $(trivy --version 2>/dev/null | head -n1)" || echo "  âŒ Trivy: Not installed";
          echo "";
          echo "ğŸš€ Additional Modern Tools:";
          command -v fzf >/dev/null && echo "  âœ… fzf: $(fzf --version 2>/dev/null)" || echo "  âŒ fzf: Not installed";
          command -v zoxide >/dev/null && echo "  âœ… zoxide: $(zoxide --version 2>/dev/null)" || echo "  âŒ zoxide: Not installed";
          command -v duf >/dev/null && echo "  âœ… duf: $(duf --version 2>/dev/null)" || echo "  âŒ duf: Not installed";
          command -v eza >/dev/null && echo "  âœ… eza: $(eza --version 2>/dev/null | head -n1)" || echo "  âŒ eza: Not installed";
          command -v btop >/dev/null && echo "  âœ… btop: $(btop --version 2>/dev/null)" || echo "  âŒ btop: Not installed";
          command -v jq >/dev/null && echo "  âœ… jq: $(jq --version 2>/dev/null)" || echo "  âŒ jq: Not installed";
          command -v yq >/dev/null && echo "  âœ… yq: $(yq --version 2>/dev/null)" || echo "  âŒ yq: Not installed";
          command -v tldr >/dev/null && echo "  âœ… tldr: $(tldr --version 2>/dev/null)" || echo "  âŒ tldr: Not installed";
          command -v ncdu >/dev/null && echo "  âœ… ncdu: $(ncdu --version 2>/dev/null)" || echo "  âŒ ncdu: Not installed";
          command -v speedtest-cli >/dev/null && echo "  âœ… speedtest-cli: $(speedtest-cli --version 2>/dev/null)" || echo "  âŒ speedtest-cli: Not installed";
          command -v procs >/dev/null && echo "  âœ… procs: $(procs --version 2>/dev/null)" || echo "  âŒ procs: Not installed";
          command -v sd >/dev/null && echo "  âœ… sd: $(sd --version 2>/dev/null)" || echo "  âŒ sd: Not installed";
          command -v broot >/dev/null && echo "  âœ… broot: $(broot --version 2>/dev/null)" || echo "  âŒ broot: Not installed";
          command -v gping >/dev/null && echo "  âœ… gping: $(gping --version 2>/dev/null)" || echo "  âŒ gping: Not installed";
          command -v fastfetch >/dev/null && echo "  âœ… fastfetch: $(fastfetch --version 2>/dev/null)" || echo "  âŒ fastfetch: Not installed";
          command -v thefuck >/dev/null && echo "  âœ… thefuck: $(thefuck --version 2>/dev/null)" || echo "  âŒ thefuck: Not installed";
          command -v choose >/dev/null && echo "  âœ… choose: $(choose --version 2>/dev/null)" || echo "  âŒ choose: Not installed";
          command -v hyperfine >/dev/null && echo "  âœ… hyperfine: $(hyperfine --version 2>/dev/null)" || echo "  âŒ hyperfine: Not installed";
          command -v just >/dev/null && echo "  âœ… just: $(just --version 2>/dev/null)" || echo "  âŒ just: Not installed";
          command -v yazi >/dev/null && echo "  âœ… yazi: $(yazi --version 2>/dev/null)" || echo "  âŒ yazi: Not installed";
          echo "";
          echo "ğŸš Shell Configuration:";
          command -v zsh >/dev/null && echo "  âœ… Zsh: $(zsh --version 2>/dev/null)" || echo "  âŒ Zsh: Not installed";
          [[ -d "/home/dev/.local/share/zinit" ]] && echo "  âœ… Zinit: Installed" || echo "  âŒ Zinit: Not installed";
        '

  health:
    desc: Check container health and system status
    cmds:
      - echo "ğŸ¥ Container Health Check:"
      - echo "=========================="
      - echo "ğŸ“Š Container Status:"
      - docker compose ps
      - echo ""
      - echo "ğŸ’¾ System Resources:"
      - docker compose exec workspace bash -c '
          echo "  CPU Usage: $(top -bn1 | grep \"Cpu(s)\" | cut -d\",\" -f1 | cut -d\":\" -f2 | tr -d \" \" || echo \"N/A\")";
          echo "  Memory Usage: $(free -h | grep Mem | awk \"{print \$3\"/\"\$2}\" || echo \"N/A\")";
          echo "  Disk Usage: $(df -h / | tail -1 | awk \"{print \$3\"/\"\$2\" (\"\$5\" used)\"}\" || echo \"N/A\")";
        '
      - echo ""
      - echo "ğŸ”§ Service Status:"
      - docker compose exec workspace bash -c 'supervisorctl status 2>/dev/null || echo "  âš ï¸  Supervisor not running"'

  test:
    desc: Run comprehensive container functionality tests
    deps: [test-tools, test-services, test-network]
    cmds:
      - echo "âœ… All tests completed!"

  test-tools:
    desc: Test essential tools functionality
    cmds:
      - echo "ğŸ”§ Testing Essential Tools:"
      - docker compose exec workspace bash -c '
          echo "  Testing Git...";
          git --version >/dev/null 2>&1 && echo "  âœ… Git: Working" || echo "  âŒ Git: Failed";
          echo "  Testing Docker...";
          docker --version >/dev/null 2>&1 && echo "  âœ… Docker: Working" || echo "  âŒ Docker: Failed";
          echo "  Testing Python...";
          python3 --version >/dev/null 2>&1 && echo "  âœ… Python: Working" || echo "  âŒ Python: Failed";
          echo "  Testing Node.js...";
          node --version >/dev/null 2>&1 && echo "  âœ… Node.js: Working" || echo "  âŒ Node.js: Failed";
        '

  test-services:
    desc: Test container services
    cmds:
      - echo "ğŸš€ Testing Container Services:"
      - docker compose exec workspace bash -c '
          echo "  Testing Supervisor...";
          supervisorctl status >/dev/null 2>&1 && echo "  âœ… Supervisor: Active" || echo "  âš ï¸  Supervisor: Not active";
          echo "  Testing SSH availability...";
          command -v sshd >/dev/null 2>&1 && echo "  âœ… SSH: Available" || echo "  âš ï¸  SSH: Not available";
        '

  test-network:
    desc: Test network connectivity
    cmds:
      - echo "ğŸŒ Testing Network Connectivity:"
      - docker compose exec workspace bash -c '
          echo "  Testing internet connectivity...";
          ping -c 1 -W 5 google.com >/dev/null 2>&1 && echo "  âœ… Internet: Connected" || echo "  âŒ Internet: Failed";
          echo "  Testing DNS resolution...";
          nslookup github.com >/dev/null 2>&1 && echo "  âœ… DNS: Working" || echo "  âŒ DNS: Failed";
        '

  # =============================================================================
  # ADVANCED DEVELOPMENT TASKS
  # =============================================================================

  dev:
    desc: Start development mode with enhanced features
    cmds:
      - echo "ğŸš€ Starting development mode..."
      - task: up
      - echo "ğŸ“ Development environment ready!"
      - echo "   â€¢ Container: http://localhost:9001 (Supervisor)"
      - echo "   â€¢ SSH: ssh -p 2222 dev@localhost"
      - echo "   â€¢ Shell: task shell"

  dev-full:
    desc: Start development mode with all tools enabled
    env:
      INSTALL_NEOVIM: "true"
      INSTALL_FD: "true"
      INSTALL_RIPGREP: "true"
      INSTALL_BAT: "true"
      INSTALL_EXA: "true"
      INSTALL_HTTPIE: "true"
      INSTALL_BOTTOM: "true"
      INSTALL_TRIVY: "true"
    cmds:
      - echo "ğŸ”§ Building full development environment..."
      - task: rebuild
      - task: dev

  dev-minimal:
    desc: Start development mode with minimal tools
    env:
      INSTALL_ANSIBLE: "false"
      INSTALL_TERRAFORM: "false"
      INSTALL_KUBECTL: "false"
      INSTALL_HELM: "false"
      INSTALL_K9S: "false"
      INSTALL_DBEAVER: "false"
    cmds:
      - echo "âš¡ Building minimal development environment..."
      - task: rebuild
      - task: dev

  backup:
    desc: Backup container data and configurations
    cmds:
      - echo "ğŸ’¾ Creating backup..."
      - mkdir -p ./backups/$(date +%Y%m%d_%H%M%S)
      - docker compose exec workspace bash -c 'tar -czf /tmp/home_backup.tar.gz -C /home/dev .' || true
      - docker cp $(docker compose ps -q workspace):/tmp/home_backup.tar.gz ./backups/$(date +%Y%m%d_%H%M%S)/
      - echo "âœ… Backup completed in ./backups/"

  restore:
    desc: Restore container data from backup
    cmds:
      - echo "ğŸ“¥ Available backups:"
      - ls -la ./backups/ 2>/dev/null || echo "No backups found"
      - echo "To restore: docker cp backup.tar.gz container:/tmp/ && docker exec container tar -xzf /tmp/backup.tar.gz -C /home/dev"

  benchmark:
    desc: Run performance benchmarks
    cmds:
      - echo "âš¡ Running performance benchmarks..."
      - docker compose exec workspace bash -c '
          echo "ğŸ”§ System Information:";
          echo "  CPU: $(lscpu | grep \"Model name\" | cut -d\":\" -f2 | xargs)";
          echo "  Memory: $(free -h | grep Mem | awk \"{print \$2}\")";
          echo "  Disk: $(df -h / | tail -1 | awk \"{print \$2}\")";
          echo "";
          echo "âš¡ Performance Tests:";
          echo "  CPU Test (calculating pi):";
          time echo "scale=1000; 4*a(1)" | bc -l >/dev/null 2>&1 || echo "  bc not available";
          echo "  Disk I/O Test:";
          time dd if=/dev/zero of=/tmp/test bs=1M count=100 2>/dev/null && rm /tmp/test || echo "  dd test failed";
        '

  security-scan:
    desc: Run security scans on the container
    cmds:
      - echo "ğŸ”’ Running security scans..."
      - docker compose exec workspace bash -c '
          if command -v trivy >/dev/null 2>&1; then
            echo "ğŸ” Scanning container with Trivy...";
            trivy fs --security-checks vuln /;
          else
            echo "âš ï¸  Trivy not installed, skipping vulnerability scan";
          fi
        '

  # =============================================================================
  # MAINTENANCE AND MONITORING TASKS
  # =============================================================================

  monitor:
    desc: Monitor container resources in real-time
    cmds:
      - echo "ğŸ“Š Starting resource monitoring (Press Ctrl+C to stop)..."
      - docker compose exec workspace bash -c '
          if command -v btm >/dev/null 2>&1; then
            btm;
          elif command -v htop >/dev/null 2>&1; then
            htop;
          else
            top;
          fi
        '

  update:
    desc: Update container tools and system packages
    cmds:
      - echo "ğŸ”„ Updating system packages..."
      - docker compose exec --user root workspace bash -c '
          dnf update -y --security;
          dnf clean all;
        '
      - echo "âœ… System packages updated!"

  docs:
    desc: Generate and serve documentation
    cmds:
      - echo "ğŸ“š Generating documentation..."
      - echo "ğŸ“– Documentation available:"
      - echo "   â€¢ README.md - Main documentation"
      - echo "   â€¢ ANALYSIS.md - Technical analysis"
      - echo "   â€¢ Dockerfile - Container definition with comments"

  config:
    desc: Show current configuration
    cmds:
      - echo "âš™ï¸  Current Configuration:"
      - echo "========================="
      - echo "ğŸ“‹ Environment Variables:"
      - cat .env | grep -E "^[A-Z]" | head -20
      - echo ""
      - echo "ğŸ³ Docker Compose Configuration:"
      - docker compose config --services
      - echo ""
      - echo "ğŸ“Š Container Status:"
      - docker compose ps

  # =============================================================================
  # DEVELOPMENT AND TESTING TASKS
  # =============================================================================

  tools:
    desc: List installed tools and their versions
    cmds:
      - echo "ğŸ“‹ Installed Development Tools:"
      - echo "================================"
      - docker compose exec workspace bash -c '
          echo "ğŸ—ï¸  Infrastructure & DevOps:";
          command -v ansible >/dev/null && echo "  âœ… Ansible: $(ansible --version | head -n1 | cut -d" " -f3)" || echo "  âŒ Ansible: Not installed";
          command -v terraform >/dev/null && echo "  âœ… Terraform: $(terraform version -json | jq -r .terraform_version)" || echo "  âŒ Terraform: Not installed";
          command -v teleport >/dev/null && echo "  âœ… Teleport: $(teleport version | head -n1 | cut -d" " -f3)" || echo "  âŒ Teleport: Not installed";
          echo "";
          echo "â˜¸ï¸  Kubernetes Tools:";
          command -v kubectl >/dev/null && echo "  âœ… kubectl: $(kubectl version --client -o json | jq -r .clientVersion.gitVersion)" || echo "  âŒ kubectl: Not installed";
          command -v helm >/dev/null && echo "  âœ… Helm: $(helm version --short)" || echo "  âŒ Helm: Not installed";
          command -v k9s >/dev/null && echo "  âœ… k9s: $(k9s version -s | grep Version | cut -d: -f2 | tr -d " ")" || echo "  âŒ k9s: Not installed";
          echo "";
          echo "ğŸ³ Container Tools:";
          command -v docker >/dev/null && echo "  âœ… Docker: $(docker --version | cut -d" " -f3 | tr -d ",")" || echo "  âŒ Docker: Not installed";
          command -v dry >/dev/null && echo "  âœ… dry: $(dry --version)" || echo "  âŒ dry: Not installed";
          command -v lazydocker >/dev/null && echo "  âœ… lazydocker: $(lazydocker --version)" || echo "  âŒ lazydocker: Not installed";
          echo "";
          echo "â˜ï¸  Cloud Tools:";
          command -v aws >/dev/null && echo "  âœ… AWS CLI: $(aws --version | cut -d" " -f1 | cut -d/ -f2)" || echo "  âŒ AWS CLI: Not installed";
          command -v cloudflared >/dev/null && echo "  âœ… Cloudflared: $(cloudflared --version | head -n1 | cut -d" " -f3)" || echo "  âŒ Cloudflared: Not installed";
          command -v tailscale >/dev/null && echo "  âœ… Tailscale: $(tailscale version | head -n1 | cut -d" " -f2)" || echo "  âŒ Tailscale: Not installed";
          echo "";
          echo "ğŸ”§ Modern CLI Tools:";
          command -v nvim >/dev/null && echo "  âœ… Neovim: $(nvim --version | head -n1 | cut -d" " -f2)" || echo "  âŒ Neovim: Not installed";
          command -v fd >/dev/null && echo "  âœ… fd: $(fd --version | cut -d" " -f2)" || echo "  âŒ fd: Not installed";
          command -v rg >/dev/null && echo "  âœ… ripgrep: $(rg --version | head -n1 | cut -d" " -f2)" || echo "  âŒ ripgrep: Not installed";
          command -v bat >/dev/null && echo "  âœ… bat: $(bat --version | cut -d" " -f2)" || echo "  âŒ bat: Not installed";
          command -v exa >/dev/null && echo "  âœ… exa: $(exa --version | head -n1 | cut -d" " -f2)" || echo "  âŒ exa: Not installed";
          command -v http >/dev/null && echo "  âœ… HTTPie: $(http --version | cut -d" " -f2)" || echo "  âŒ HTTPie: Not installed";
          command -v btm >/dev/null && echo "  âœ… bottom: $(btm --version | cut -d" " -f2)" || echo "  âŒ bottom: Not installed";
          command -v trivy >/dev/null && echo "  âœ… Trivy: $(trivy --version | head -n1 | cut -d" " -f2)" || echo "  âŒ Trivy: Not installed";
        '

  health:
    desc: Check container health and system status
    cmds:
      - echo "ğŸ¥ Container Health Check:"
      - echo "=========================="
      - echo "ğŸ“Š Container Status:"
      - docker compose ps
      - echo ""
      - echo "ğŸ’¾ System Resources:"
      - docker compose exec workspace bash -c '
          echo "  CPU Usage: $(top -bn1 | grep "Cpu(s)" | cut -d"," -f1 | cut -d":" -f2 | tr -d " ")";
          echo "  Memory Usage: $(free -h | grep Mem | awk "{print \$3\"/\"\$2}")";
          echo "  Disk Usage: $(df -h / | tail -1 | awk "{print \$3\"/\"\$2\" (\"\$5\" used)\"}")";
        '
      - echo ""
      - echo "ğŸ”§ Service Status:"
      - docker compose exec workspace bash -c 'supervisorctl status' || echo "  âš ï¸  Supervisor not running"

  test:
    desc: Run container functionality tests
    cmds:
      - echo "ğŸ§ª Running Container Tests:"
      - echo "==========================="
      - task: test-tools
      - task: test-services
      - task: test-network

  test-tools:
    desc: Test essential tools functionality
    cmds:
      - echo "ğŸ”§ Testing Essential Tools:"
      - docker compose exec workspace bash -c '
          echo "  Testing Git...";
          git --version >/dev/null && echo "  âœ… Git: Working" || echo "  âŒ Git: Failed";
          echo "  Testing Docker...";
          docker --version >/dev/null && echo "  âœ… Docker: Working" || echo "  âŒ Docker: Failed";
          echo "  Testing Python...";
          python3 --version >/dev/null && echo "  âœ… Python: Working" || echo "  âŒ Python: Failed";
          echo "  Testing Node.js...";
          node --version >/dev/null && echo "  âœ… Node.js: Working" || echo "  âŒ Node.js: Failed";
        '

  test-services:
    desc: Test container services
    cmds:
      - echo "ğŸš€ Testing Container Services:"
      - docker compose exec workspace bash -c '
          echo "  Testing SSH service...";
          systemctl is-active ssh >/dev/null 2>&1 && echo "  âœ… SSH: Active" || echo "  âš ï¸  SSH: Not active";
          echo "  Testing Supervisor...";
          supervisorctl status >/dev/null 2>&1 && echo "  âœ… Supervisor: Active" || echo "  âš ï¸  Supervisor: Not active";
        '

  test-network:
    desc: Test network connectivity
    cmds:
      - echo "ğŸŒ Testing Network Connectivity:"
      - docker compose exec workspace bash -c '
          echo "  Testing internet connectivity...";
          ping -c 1 google.com >/dev/null 2>&1 && echo "  âœ… Internet: Connected" || echo "  âŒ Internet: Failed";
          echo "  Testing DNS resolution...";
          nslookup github.com >/dev/null 2>&1 && echo "  âœ… DNS: Working" || echo "  âŒ DNS: Failed";
        '
